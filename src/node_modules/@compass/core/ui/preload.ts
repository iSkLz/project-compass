import path from "path";
import fs from "fs";
import { paths } from "@libs/helpers";

// TODO: Is it just... possible to do this cleanly?
export const preloadFunction = fs.readFileSync(path.join(module.path, "preloadinjector.js"), "utf8");
export const preloadScript = ((...args: any[]) =>
    `${preloadFunction}(${args.map((arg) => `'${arg.toString().replaceAll("'", '\\"')}'`.replaceAll("\\", "/")).join(', ')})`
);
export const preloadFile = ((ID: string, script: string) => {
    let filePath = paths.tempDir("preloads")(`${ID}.js`);
    fs.writeFileSync(filePath, script);
    return filePath;
});